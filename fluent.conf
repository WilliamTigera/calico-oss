<source>
  @type tail
  @id in_tail_flow_logs
  path "#{ENV['FLOW_LOG_FILE']}"
  pos_file "#{ENV['FLOW_LOG_FILE']}.pos"
  tag flows
  read_from_head true
  <parse>
    @type json
  </parse>
</source>

<filter flows>
  @type record_transformer
  <record>
    host "#{Socket.gethostname}"
  </record>
</filter>

<match flows>
  @type elasticsearch
  host "#{ENV['ELASTIC_HOST']}"
  port "#{ENV['ELASTIC_PORT']}"
  index_name tigera_secure_ee_flows
  template_file /fluentd/etc/elastic_mapping_flows.template
  template_name tigera_secure_ee_flows
</match>

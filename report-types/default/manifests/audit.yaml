apiVersion: projectcalico.org/v3
kind: GlobalReportType
metadata:
  creationTimestamp: null
  labels:
    global-report-type: audit
  name: audit
spec:
  auditEventsSelection:
    resources:
    - kind: GlobalNetworkPolicy
    - kind: NetworkPolicy
  downloadTemplates:
  - name: summary.csv
    template: |
      startTime,endTime,numCreatedPolicies,numModifiedPolicies,numDeletedPolicies
      {{ dateRfc3339 .StartTime }},{{ dateRfc3339 .EndTime }},{{ .AuditSummary.NumCreate }},{{ .AuditSummary.NumModify }},{{ .AuditSummary.NumDelete }}
  - name: events.json
    template: |
      {{ toJson .AuditEvents }}
  - name: events.yaml
    template: |
      {{ toYaml .AuditEvents }}
  uiSummaryTemplate:
    name: ui-summary.json
    template: '{"heading":"Network policy configuration changes","type":"panel","widgets":[{"data":[{"label":"Created","value":{{
      .AuditSummary.NumCreate }}}],"heading":"Network policies created","summary":{"label":"Total","total":{{
      .AuditSummary.NumTotal }}},"type":"radialbarchart"},{"data":[{"label":"Modified","value":{{
      .AuditSummary.NumModify }}}],"heading":"Network policies modified","summary":{"label":"Total","total":{{
      .AuditSummary.NumTotal }}},"type":"radialbarchart"},{"data":[{"label":"Deleted","value":{{
      .AuditSummary.NumDelete }}}],"heading":"Network policies deleted","summary":{"label":"Total","total":{{
      .AuditSummary.NumTotal }}},"type":"radialbarchart"}]}'

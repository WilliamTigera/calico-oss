- apiVersion: v1
  kind: profile
  metadata:
    name: group1
  spec:
    ingress:
    - action: allow
      source:
        selector: calico/k8s_ns == 'group1'
- apiVersion: v1
  kind: profile
  metadata:
    name: group2
  spec:
    ingress:
    - action: allow
      source:
        selector: calico/k8s_ns == 'group2'
- apiVersion: v1
  kind: workloadEndpoint
  metadata:
    name: eth0
    workload: g1w1
    orchestrator: k8s
    node: host1
    labels:
      app: frontend
      calico/k8s_ns: group1
  spec:
    interfaceName: cali0ef24ba
    mac: ca:fe:1d:52:bb:e1
    ipNetworks:
    - 192.168.0.1/32
    profiles:
    - group1
- apiVersion: v1
  kind: workloadEndpoint
  metadata:
    name: eth0
    workload: g1w2
    orchestrator: k8s
    node: host1
    labels:
      app: frontend
      calico/k8s_ns: group1
  spec:
    interfaceName: cali0ef24ba
    mac: ca:fe:1d:52:bb:e2
    ipNetworks:
    - 192.168.0.2/32
    profiles:
    - group1
- apiVersion: v1
  kind: workloadEndpoint
  metadata:
    name: eth0
    workload: g1w3
    orchestrator: k8s
    node: host1
    labels:
      app: frontend
      calico/k8s_ns: group1
  spec:
    interfaceName: cali0ef24ba
    mac: ca:fe:1d:52:bb:e3
    ipNetworks:
    - 192.168.0.3/32
    profiles:
    - group1
- apiVersion: v1
  kind: workloadEndpoint
  metadata:
    name: eth0
    workload: g2w1
    orchestrator: k8s
    node: host1
    labels:
      app: frontend
      calico/k8s_ns: group2
  spec:
    interfaceName: cali0ef24ba
    mac: ca:fe:1d:52:bb:f1
    ipNetworks:
    - 192.168.1.1/32
    profiles:
    - group2
- apiVersion: v1
  kind: workloadEndpoint
  metadata:
    name: eth0
    workload: g2w2
    orchestrator: k8s
    node: host1
    labels:
      app: frontend
      calico/k8s_ns: group2
  spec:
    interfaceName: cali0ef24ba
    mac: ca:fe:1d:52:bb:f2
    ipNetworks:
    - 192.168.1.2/32
    profiles:
    - group2
- apiVersion: v1
  kind: workloadEndpoint
  metadata:
    name: eth0
    workload: g2w3
    orchestrator: k8s
    node: host1
    labels:
      app: frontend
      calico/k8s_ns: group2
  spec:
    interfaceName: cali0ef24ba
    mac: ca:fe:1d:52:bb:f3
    ipNetworks:
    - 192.168.1.3/32
    profiles:
    - group2
- apiVersion: v1
  kind: policy
  metadata:
    name: p1
  spec:
    selector: calico/k8s_ns == 'group1'
    order: 500
    egress:
    - action: deny
      destination:
        selector: calico/k8s_ns == 'group1'
    ingress:
    - action: allow
      source:
        selector: calico/k8s_ns == 'group2'
- apiVersion: v1
  kind: policy
  metadata:
    name: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ
  spec:
    selector: calico/k8s_ns == 'group2'
    order: 400
    egress:
    - action: allow
      destination:
        selector: calico/k8s_ns in {'group1','group2'}
    ingress:
    - action: deny
      source:
        selector: calico/k8s_ns in {'group1','group2'}

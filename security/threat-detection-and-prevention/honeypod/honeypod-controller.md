---
title: Using Honeypod controller to provide packet inspection on suspicious traffic
description: Monitor Honeypods and scan traffic with a packet inspection engine
canonical_url: /security/threat-detection-and-prevention/honeypod/honeypod-controller
---

### Big picture

[Honeypods]({{site.baseurl}}/security/threat-detection-and-prevention/honeypod/honeypods) provides a way to detect compromised resources within your cluster, Honeypod controller can be deployed on top of Honeypods to monitor its behavior and gain insight on what the attackers is doing.

### Value

The controller extends Honeypods by providing a way to monitor suspicious traffic reaching the Honeypods and generate alerts if the traffic matches any Intrusion Detection System(Snort) signatures. If the controller detects activities within the Honeypods, it will trigger an Snort scan on the traffic reaching the Honeypods. 


### Features

This how-to guide uses the following Calico Enterprise features:

- **PacketCapture** with **Honeypod controller**

### Concepts

- The Honeypod controller leverage the [PacketCapture]({{site.baseurl}}/security/threat-detection-and-prevention/packetcapture) feature to collect traffic related to Honeypods deployed in the cluster
- [Snort](https://www.snort.org/) is used to scan Honeypod traffic
- Alerts generated by the Honeypod controller can be found in the Alerts tab of the Calico Enterprise Manager UI

### How To

  - [Ensure Honeypods are deployed](#ensure-honeypods-are-deployed)
  - [Deploy Honeypod controller manifest](#deploy-honeypod-controller-manifest)

#### Ensure Honeypods are deployed

Review [Honeypods]({{site.baseurl}}/security/threat-detection-and-prevention/honeypod/honeypods) installation guide and that Alerts are generated when the Honeypods are accessed.

#### Deploy Honeypod controller manifest

Apply the Honeypod Controller manifest into the cluster using the following command:

```shell
kubectl apply -f {{ "/manifests/threatdef/honeypod/controller.yaml" | absolute_url }} 
```

### Usage

The Honeypod Controller will periodically poll for any suspicious activity in the selected Honeypods and scans its traffic. Any alerts generated will be in the Events tab of Calico Enterprise.
<filter audit.eks>
  @type grep
  <regexp>
    key level
    pattern /RequestResponse/
  </regexp>
  <regexp>
    key verb
    pattern /^create$|^patch$|^update$|^delete$/
  </regexp>
</filter>

<filter audit.eks>
  @type record_transformer
  enable_ruby
  <record>
    # Create a name field from the objectRef.name, responseObject.metadata.name or responseObject.details.name
    name ${record["responseObject"].nil? ? (record["objectRef"].nil? ? "-" : record["objectRef"]["name"]) :	(record["responseObject"]["metadata"].nil? ? record["responseObject"]["details"]["name"] : record["responseObject"]["metadata"]["name"])}
    # EKS doesn't send timestamp, use stageTimestamp to populate one.
    timestamp ${record["stageTimestamp"]}
  </record>
</filter>

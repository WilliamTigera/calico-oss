kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tigera-elasticsearch-access-all
rules:
- apiGroups: ["lma.tigera.io"]
  resources: ["index"]
  resourceNames: ["flows", "audit*", "audit_kube", "audit_ee", "events"]
  verbs: ["get"]
---
   
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tigera-access-networkpolicy
rules:
- apiGroups: ["projectcalico.org"]
  resources: ["networkpolicy"]
  resourceNames: ["*"]
  verbs: ["get","put","post","delete"]   

---
    
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tigera-elasticsearch-access-flowonly
rules:
- apiGroups: ["lma.tigera.io"]
  resources: ["index"]
  resourceNames: ["flows"]
  verbs: ["get"]
---

kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tigera-elasticsearch-access-auditonly
rules:
- apiGroups: ["lma.tigera.io"]
  resources: ["index"]
  resourceNames: ["audit*", "audit_kube", "audit_ee"]
  verbs: ["get"]
---

kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tigera-elasticsearch-access-audit_kube-only
rules:
- apiGroups: ["lma.tigera.io"]
  resources: ["index"]
  resourceNames: ["audit_kube"]
  verbs: ["get"]

---
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tigera-path-to-something
rules:
- nonResourceURLs: ["/path/to/something"]
  verbs: ["get"]

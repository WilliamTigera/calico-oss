<ROOT>
  <source>
    @type cloudwatch_logs
    tag "audit.eks"
    log_group_name "/aws/eks/eks-audit-test/cluster/"
    use_log_stream_name_prefix true
    log_stream_name "kube-apiserver-audit-overwritten-"
    state_file "/fluentd/log/eks-audit.state"
    use_aws_timestamp true
  </source>
  <filter audit.eks>
    @type grep
    <regexp>
      key "level"
      pattern /RequestResponse/
    </regexp>
    <regexp>
      key "verb"
      pattern /^create$|^patch$|^update$|^delete$/
    </regexp>
  </filter>
  <match audit.eks>
    @type stdout
  </match>
</ROOT>

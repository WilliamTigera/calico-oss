  <store>
    @type splunk_hec
    protocol "#{ENV['SPLUNK_WAF_PROTOCOL']}"
    hec_host "#{ENV['SPLUNK_WAF_HEC_HOST']}"
    hec_port "#{ENV['SPLUNK_WAF_HEC_PORT']}"
    hec_token "#{ENV['SPLUNK_WAF_HEC_TOKEN']}"
    index "#{ENV['SPLUNK_WAF_INDEX']}"
    sourcetype "#{ENV['SPLUNK_WAF_SOURCETYPE']}"
    source "#{ENV['SPLUNK_WAF_SOURCE']}"
    ca_file "#{ENV['SPLUNK_CA_FILE']}"
    <format>
      @type json
    </format>
    <buffer>
      flush_mode interval
      flush_interval "#{ENV['SPLUNK_WAF_FLUSH_INTERVAL']}"
      flush_thread_count "#{ENV['SPLUNK_WAF_FLUSH_THREAD_COUNT']}"
    </buffer>
  </store>

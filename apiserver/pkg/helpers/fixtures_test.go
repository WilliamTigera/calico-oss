// Copyright (c) 2020 Tigera, Inc. All rights reserved.

package helpers

// Sample of a CA key required by managed clusters API to
// generate certificates
const PKCS1Key = `
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA26LwxnbRl2LMTkpH8AM6WUfMbN7Hjbm/h/G6RN40FUX1QRIt
RET3MKQ1UIWnWJkxnbyD7UF3/Vhum6sqXYt8s0QtKt0AZ0xJSE0TiQ02CCBaL/O+
dz9HAvJ1S2EG2eYZ2aOw8mB/iWHLAkK4LxZcpydgEMmOzfe5d9/Wk311S6zzHvyW
yvrC0UC/0hOOGPYdLgFpo2GVwQ2u2y67Fl7Uet2rayrhZPPNucvyiAGpc8UK19Bx
jOkynh8LfczUpOp0Pxs21cPLjii2cJUM2JWakGN4oxqr1y7Tz7QZ8c0xwM3vkqTN
hOwF/n4RS2+I+oUyMCor2KP/2gVM8QW0Wl1jmQIDAQABAoIBAGpjXd+0dEexKqeN
oZTn616Nwb7GlsDWxajS9Vggjff0AB158YVNJrNgBxcu9mWbJwZx5zGIcde8+y7a
VVYkl82562sEzAo9UI3+D8VmKdL74NOzbIIUm5AY46oUoJ3xsHnUqYRuK7jfLte0
e8ULPuwUzZq0F0E7ipI/UY/1yFhT01lUhvXxXlRBLnN95dq4fGs2v5GltUyZrlXO
7brLbkKBfh6v766QstKZzZiLi13/kyXpXd2aRql9fUmG0EZ4CMP0UQlRLMWqHXme
1eXX3fVq4ZBfE0Zu+RnuNND05RtZCQJ55XfhcoUnmtGMwxwW5SteAHUm7EJhX18k
CGiUHTUCgYEA8a09tFkDX18tW4Z3994OmAm+Ebz7b7nadz9iUuBrU3QeQeTZx0QS
XsqOl5S7Psyu2EmXnlsh8odrbpzFuG48Xf5dc84aywvUZakSkPL+WXDaaBgK5XOv
1A0y6d15e0Nevy3sxkMB6anupP22iqWpTqZHhmSBDrLMPTc3mYFN8j8CgYEA6KdN
KPSObg2bZ+9Zi7m2T5K76fTrpyBcWHE7sIZ0lpUoEK3jP2nd/q12ZnioJeqmSd2L
xIirax8YZMisQoQ9Vq2qIizPffMymxXob66cT/FovDJyREJ2frlr+xiMBFtF4Yl1
3I0KthQkVHLB0Ys0Nu/lmWeHa11aas64dLorhCcCgYAh0rEUEHEcY+GhMYyQsA8y
0Ao9yUkXNdeRYNmN58Kdh17EshaYgLphcc/K/xHFlDfUJViG3RI/Mxyh+mbhjOv9
65+AmZO+XwV2xNbIWnmmYtjuQI8l1a8B6mb5u/lIewFDmFXO2Ynm/dVcWfW2KcEs
NLFF6cL2H6fd2WB6p1IVWQKBgF33pLyT+isNJ+WU0NAUlEQTef6Gw99evK2kHn2v
8MsZN3N1KEHmmplQqm+87/1QhxVyfA9HPCUqDAo42wqKqtOllP/0pWGzpo7pDFZ/
afcIBEtu/KQBTCbm8WwbgAIKc3Eiug34kYj1Ha9WIl5mIRLHVi7dl96PeAOHtwy+
XPElAoGBAKG6Lj9Hf8vvuKl8SJ37aAgN3ilOyMA1ljd+Qf+HJbY6LvUZ5OiedxgJ
4u8+Iwwm2DqL04x/9JAO7Af9EO2X/5l350kcTabVw8MLY3eXrGZ4B/A+uyjKeQfb
YpLy9Og9qOtmwkHfBElil5dOjJQud3D01cXFB8hQ8BiKGXiRawVg
-----END RSA PRIVATE KEY-----
`

// Not supported format for private key
const PKCS8Key = `
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQChomwJG5RMgMwG
e0oFVHyNVt0Gj7mmClSJ9a145M2MDpvv8KEQnAQth3hwCVVJGLPE2zWxtI3qh0kW
8+g5C0aPreavOdc8W+BxbRmWI8CDNym1u41zF+t9BQo4RmxjsfAbGT/UPgorwyi2
hJFDP0WDF5doHG9JYFVkkH9nnUVunSbEFR4Y4zrqS/+Ur3E4Tp5E+Jq61aSsXX+V
zOXvRKyafjfgKBUgGDOdErzrpVhrNapsEagCUL/ED7pvlXv+sSSDmg//jxA2o9/a
UZgpPTcqSDsIgh8barXbldv3ooXF1qYHVKFTgUQt8+Imu+GhWjTLTUtrmZEeGuRe
9hmFlC/HAgMBAAECggEAYudmQDR2DFILhjPO2XAXPs1WNfugV++eR0Tjv0QSWo9d
7/ZIOEefbtSkZ7nuS+onpl+UfYbECCx8FuVsxesWZDi/HZ3BDJgTwJRHwc1isWgB
x8haB4EtgbShykmdbWumRo6utgq4Yorq0LRRxtpiiJLY/MXZewbNednJe/eKUuIx
idwVYX0E3wYhxpQs+zu5bOw7uHuhE541u+ry/QRPpQoHPMy8KfG8vJy0dA4GymIi
Ioid7BB0pqa8QmGq4lG+qrF2C74376J2nx5OTsrhw2dnAfUUZaTDlXlIx9lSZXxd
iLlLi3tVBQZD4EOcV1dFhwEA+K+t/bc+kDYqg2jwsQKBgQDS0W6XFM+eNlaHBxhH
B1OvVJskVSCJYyYlfwgbLoybpB/373zKbQq/7ihzipQHa9HGDG1coAQKn6I4xRw0
7czWGi7PhGOrK8PCp3PWYgGXaFCDek6XO4NXQYUu0cLMRzEzWWFmp9r98T5w/6RX
GxZ4QA5GlPP0Mt9bfZ19r8ZclQKBgQDERoWxw5k1VmSEW8JseIzMFGWhKeVonEXi
qVWojI5C7O9jZxzj7hB17ZgYhq1uaUPEEVWRSAjbWSK8C1c+iZQVCDg3N5BwM8EW
aLnlmMB3O2Qvw9l6zxTnNkGp1X1Mfm/oVlju07IEZ+sZCowXWybC+ho8bg1HwEmq
nYVUFbin6wKBgQDHJ2/Yq6FCrcRqBKrLlsFYlY2F8iEtiIulym6G9x9/fLlyiDwU
IpSQIdT26YfTxuhBtsWtRcDrpEgkZxixa6Ag9lUYVtGtB0gEYBpPAQDN3o6I1gbe
WStHR68gPqpOPkbdYmdgCdwYH0lEiEvgucctTB3wUZBwNYrJLE6WSHIUTQKBgDyM
7Q3MI+W6g0P58t73yafj2v5/KFC/dSfZyZ03z2OCKM/nrZf7h4R6CeP3GGXpf4hr
OJSbPnA87WRJs16NnutmH8GZGKwkqzq4kDDukOG3ps69gshKPk6eBF/ahs8kam2o
xcLX+CE31eVhxZom+qxH7/QYl2w9O/ywn8My+EaFAoGBAL6bC59LCnJja8HeNi3w
mcIqc/fdYj1vMYNwF7x2qXYe429xeBfTIOdc17XVNjIwnSg7iOO6z2IlMsGt7pPV
PKt1ehZ23YCwaXDZr8XN1d15woNxH2Fbz1xBp2J7i7Z43UjdSBsj9Zb1qqGTW6tL
vzsGxyAQsGU4w44lAcT1PWjm
-----END PRIVATE KEY----`

// Sample of a CA cert required by managed clusters API to
// generate certificates
const CACert = `
-----BEGIN CERTIFICATE-----
MIIC5DCCAcygAwIBAgIBATANBgkqhkiG9w0BAQsFADAZMRcwFQYDVQQDEw50aWdl
cmEtdm9sdHJvbjAeFw0yMDA2MDQxNDEzMjBaFw0yNTA2MDMxNDEzMjBaMBkxFzAV
BgNVBAMTDnRpZ2VyYS12b2x0cm9uMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB
CgKCAQEA26LwxnbRl2LMTkpH8AM6WUfMbN7Hjbm/h/G6RN40FUX1QRItRET3MKQ1
UIWnWJkxnbyD7UF3/Vhum6sqXYt8s0QtKt0AZ0xJSE0TiQ02CCBaL/O+dz9HAvJ1
S2EG2eYZ2aOw8mB/iWHLAkK4LxZcpydgEMmOzfe5d9/Wk311S6zzHvyWyvrC0UC/
0hOOGPYdLgFpo2GVwQ2u2y67Fl7Uet2rayrhZPPNucvyiAGpc8UK19BxjOkynh8L
fczUpOp0Pxs21cPLjii2cJUM2JWakGN4oxqr1y7Tz7QZ8c0xwM3vkqTNhOwF/n4R
S2+I+oUyMCor2KP/2gVM8QW0Wl1jmQIDAQABozcwNTAOBgNVHQ8BAf8EBAMCAqQw
DwYDVR0TAQH/BAUwAwEB/zASBgNVHREECzAJggd2b2x0cm9uMA0GCSqGSIb3DQEB
CwUAA4IBAQA2760ivm0D7QTlJKdHvM869E8fS5IcWH5D7PwZsDt6WEWRhXUN2K+B
+/kZ7bt16Sy6L4Xdewqm/ZZ3/PjYQ1+EQ23sC/N6kHy5IDwMfJOh7bw+1e6XjJw2
d1p0eo7UptbRiQAfYpjDGYBBmYrpUAb8KGrt6ereSYHvebjtBfCdu/qIZHbcHwB8
vkE8P3fnxkshr++1uqXob5oJyPusdYTak+SCSwfDY40uTrzO2jJkVcXP7uki4Ogd
wQ7Ezpr+yoNGtsN0SRuvu7tPpjMaZh++dfZcBoNRawVuyaUkssEyGUo1sJiTlReC
19e5+45DtLkao7mWfKdECF75KIpUS1uD
-----END CERTIFICATE-----
`

// Sample of a client certificate key generated for a managed cluster
const ClientCert = `
-----BEGIN CERTIFICATE-----
MIIC3jCCAcagAwIBAgIQN9hi0pKq+OuMa9wHQrigyjANBgkqhkiG9w0BAQsFADAZ
MRcwFQYDVQQDEw50aWdlcmEtdm9sdHJvbjAgFw0yMDA2MTAwMDUyMjhaGA8yMTM0
MDcwOTE2NTIyOFowEjEQMA4GA1UEAxMHYm9ndXMtNDCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAK9F3mWQPsf4T2WfBjE/38ZFIbWxIZKagdaV0e/2FGP1
Jt6/cT3ERHb8wzySRdSniev3k92mQHgBDQEfw6Gl2iRw2QyMI3PT8IjA/bkUP1et
nQ3967zNO1F5lIls29SGhdkBSgKGi6gSh3QDb6S43DQRwqgA5CCfx3IVLG6egD6j
v22liNPKltcbPJBJS25mdIuyYzgsEKbQs+3v3NWGFDgxBv84fTUq7WtzcqHbPgiy
UTzA68ViBfaJODPqPIuLDxV3KRMva1cRJ9Z+1pcsFFqAXql+JM2g3DTrPLfb0j76
f1THi4fyzCeB7Cyipy2hqB2H1H3RQq2DLQivdTekIJUCAwEAAaMnMCUwDgYDVR0P
AQH/BAQDAgWgMBMGA1UdJQQMMAoGCCsGAQUFBwMCMA0GCSqGSIb3DQEBCwUAA4IB
AQDIfgKN/pyTUrfZYs2+2cWdCgDr1bttvyn+d4GpAuZw6vrDCny8b9ymGsRXASrB
kaHFCOQ1wt+ywxpD3FTYFiKb14NMQlQGRUGAv01kJ8nyeDhW61kgENZAks9FRFcU
E9+B6fkYiRByXU7AkKUVD883eQzHs4pcJcvPmthgLei1P1G/MPqVYAP7LvysFnjT
8w4zR17sSdIT574aUNt17M2qMOlGGRpemeVGRZF3gupVXj7i8I26kyCLL1SvJWoe
gFTCQRdbe1djvPD5RcUJSJVxMYV2noz/THOt3zLAqIt3y6TdLa+fOJ/4Iwu0aDLD
gh3GrhmURJ/KVlE8A1gB8ZWi
-----END CERTIFICATE-----`

// Sample of a client private key generated for a managed cluster
const ClientKey = `
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAr0XeZZA+x/hPZZ8GMT/fxkUhtbEhkpqB1pXR7/YUY/Um3r9x
PcREdvzDPJJF1KeJ6/eT3aZAeAENAR/DoaXaJHDZDIwjc9PwiMD9uRQ/V62dDf3r
vM07UXmUiWzb1IaF2QFKAoaLqBKHdANvpLjcNBHCqADkIJ/HchUsbp6APqO/baWI
08qW1xs8kElLbmZ0i7JjOCwQptCz7e/c1YYUODEG/zh9NSrta3Nyods+CLJRPMDr
xWIF9ok4M+o8i4sPFXcpEy9rVxEn1n7WlywUWoBeqX4kzaDcNOs8t9vSPvp/VMeL
h/LMJ4HsLKKnLaGoHYfUfdFCrYMtCK91N6QglQIDAQABAoIBACy9gASa6nuvFc1R
54nAzUVWNkGj4ncCu6vj+H/xZ8kQNgjcA3MJ25Qn90pJ6EtdLOav/u2wV3qKgiBM
VGq55FIzACSkzRPvANJXuSx6T6T460M8EuXR2Zd1moXt5Lt+T0JSgurcH2AawrrJ
ecEpcwRTmEW8XH87afTkFMBz8zaJt8j7Te17KD6zEbhAoEjoFkpq8AYEF/r7uO25
N1p0Cr4FNJ2e64PGiw5nVYpNwt0LewTZWm9gKzMaAUXxnApWOHWX1Dh3QfuvFozX
aZ/0+hLBH+hc/O9M+1arqnbxoJnwQ+DbUEcJv2RCFqsmeGXYcpE8oNITT3na9PpC
2Flbiy0CgYEAzIAJWAbazrAuxALwDzRNHGIA4Jtl0g0ZWRffdQMwp5q18jNQG7/2
Hg18eqRL3vqHA5C7m8kKkw1q0xawDDnR5uAPq5sV9yRsQMqW6k4fTWD8/KCFY51k
SWYXeSsHA5QsMEQMxEGV3OeN77GRtEI7WrUa3PAR8nZm+qwuRK+zR4cCgYEA22mT
k5k2RUUI5aQBteQfUyLF5uw5fV8I37/L3P/9uJuVg8JxQwpkX6Rxe8iP28K0uKYI
G8bdTwWAkmFrEOdJ3Pe+t/9qG6BVUxXKx4W/LSuwHjx/ahiQg8FcVsi1qGbRV3MM
BM1Jgj+EajaVjeawUMeDmVLkD+kXCtDO8utB5gMCgYBz4aXp1NCOyPVnK0b/RqLf
j4VxwX08PyH7A3UjqHAcuaWanospfmin9PpxwMIhk5OIaK53A8BTPgonnbaa5vTT
wGoA0zvqNSCGwoYsNaK1RV12hjuwDBM1KH3qsoAh/gfgPd+CIqwaZrheeB/ZpqJd
rzyOsBdrbr7CE2mQkIOl5wKBgAeYryhUDKH3UuiIdhqzDDaXpJxrH05s5OTCQi+j
mUgz8sg+CifVC0aYbeloNzrXkeQ2s18q0myy9xGaV9ec+lyxIyRBro3ITkvzHDMu
OUE6Gv3hAFRPB2nYXvcOOePbs3HApPDhnqLoyg/XVfQ0wXP6hF7hlM3MNyUDt7aH
WJ+7AoGBAKCxxPXo3mAdWxnXhQtg4+iDdjZesD0W41AXOVjgQei8+o+YpRcEInzL
qIG/yOoZYzmMaceb3WPH/XWSAAH9/BbpsheaajJWjPP9prSRNBD7ApSbJxA6ItcE
ojyi3rZsGLKz7y1hB+zTNebftHjWCmV+Ho+tlG/xI6M94p1/1q0p
-----END RSA PRIVATE KEY-----`

// Sample of installation manifest that will be generated when creating
// a managed cluster
const ExpectedManifest = `
# Once applied to your managed cluster, a deployment is created to establish a secure tcp connection
# with the management cluster.

apiVersion: operator.tigera.io/v1
kind: ManagementClusterConnection
metadata:
  name: tigera-secure
spec:
  # ManagementClusterAddr should be the externally reachable address to which your managed cluster
  # will connect. Valid examples are: "0.0.0.0:31000", "example.com:32000", "[::1]:32500"
  managementClusterAddr: "example.org:1234"

---

apiVersion: v1
kind: Secret
metadata:
  name: tigera-managed-cluster-connection
  namespace: operator-ns
type: Opaque
data:
  # This is the certificate of the management cluster side of the tunnel.
  management-cluster.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1RENDQWN5Z0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFaTVJjd0ZRWURWUVFERXc1MGFXZGwKY21FdGRtOXNkSEp2YmpBZUZ3MHlNREEyTURReE5ERXpNakJhRncweU5UQTJNRE14TkRFek1qQmFNQmt4RnpBVgpCZ05WQkFNVERuUnBaMlZ5WVMxMmIyeDBjbTl1TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCCkNnS0NBUUVBMjZMd3huYlJsMkxNVGtwSDhBTTZXVWZNYk43SGpibS9oL0c2Uk40MEZVWDFRUkl0UkVUM01LUTEKVUlXbldKa3huYnlEN1VGMy9WaHVtNnNxWFl0OHMwUXRLdDBBWjB4SlNFMFRpUTAyQ0NCYUwvTytkejlIQXZKMQpTMkVHMmVZWjJhT3c4bUIvaVdITEFrSzRMeFpjcHlkZ0VNbU96ZmU1ZDkvV2szMTFTNnp6SHZ5V3l2ckMwVUMvCjBoT09HUFlkTGdGcG8yR1Z3UTJ1Mnk2N0ZsN1VldDJyYXlyaFpQUE51Y3Z5aUFHcGM4VUsxOUJ4ak9reW5oOEwKZmN6VXBPcDBQeHMyMWNQTGppaTJjSlVNMkpXYWtHTjRveHFyMXk3VHo3UVo4YzB4d00zdmtxVE5oT3dGL240UgpTMitJK29VeU1Db3IyS1AvMmdWTThRVzBXbDFqbVFJREFRQUJvemN3TlRBT0JnTlZIUThCQWY4RUJBTUNBcVF3CkR3WURWUjBUQVFIL0JBVXdBd0VCL3pBU0JnTlZIUkVFQ3pBSmdnZDJiMngwY205dU1BMEdDU3FHU0liM0RRRUIKQ3dVQUE0SUJBUUEyNzYwaXZtMEQ3UVRsSktkSHZNODY5RThmUzVJY1dINUQ3UHdac0R0NldFV1JoWFVOMksrQgorL2taN2J0MTZTeTZMNFhkZXdxbS9aWjMvUGpZUTErRVEyM3NDL042a0h5NUlEd01mSk9oN2J3KzFlNlhqSncyCmQxcDBlbzdVcHRiUmlRQWZZcGpER1lCQm1ZcnBVQWI4S0dydDZlcmVTWUh2ZWJqdEJmQ2R1L3FJWkhiY0h3QjgKdmtFOFAzZm54a3NocisrMXVxWG9iNW9KeVB1c2RZVGFrK1NDU3dmRFk0MHVUcnpPMmpKa1ZjWFA3dWtpNE9nZAp3UTdFenByK3lvTkd0c04wU1J1dnU3dFBwak1hWmgrK2RmWmNCb05SYXdWdXlhVWtzc0V5R1VvMXNKaVRsUmVDCjE5ZTUrNDVEdExrYW83bVdmS2RFQ0Y3NUtJcFVTMXVECi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  # The certificate and private key that are created and signed by the CA in the management cluster.
  managed-cluster.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMzakNDQWNhZ0F3SUJBZ0lRTjloaTBwS3ErT3VNYTl3SFFyaWd5akFOQmdrcWhraUc5dzBCQVFzRkFEQVoKTVJjd0ZRWURWUVFERXc1MGFXZGxjbUV0ZG05c2RISnZiakFnRncweU1EQTJNVEF3TURVeU1qaGFHQTh5TVRNMApNRGN3T1RFMk5USXlPRm93RWpFUU1BNEdBMVVFQXhNSFltOW5kWE10TkRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCCkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUs5RjNtV1FQc2Y0VDJXZkJqRS8zOFpGSWJXeElaS2FnZGFWMGUvMkZHUDEKSnQ2L2NUM0VSSGI4d3p5U1JkU25pZXYzazkybVFIZ0JEUUVmdzZHbDJpUncyUXlNSTNQVDhJakEvYmtVUDFldApuUTM5Njd6Tk8xRjVsSWxzMjlTR2hka0JTZ0tHaTZnU2gzUURiNlM0M0RRUndxZ0E1Q0NmeDNJVkxHNmVnRDZqCnYyMmxpTlBLbHRjYlBKQkpTMjVtZEl1eVl6Z3NFS2JRcyszdjNOV0dGRGd4QnY4NGZUVXE3V3R6Y3FIYlBnaXkKVVR6QTY4VmlCZmFKT0RQcVBJdUxEeFYzS1JNdmExY1JKOVorMXBjc0ZGcUFYcWwrSk0yZzNEVHJQTGZiMGo3NgpmMVRIaTRmeXpDZUI3Q3lpcHkyaHFCMkgxSDNSUXEyRExRaXZkVGVrSUpVQ0F3RUFBYU1uTUNVd0RnWURWUjBQCkFRSC9CQVFEQWdXZ01CTUdBMVVkSlFRTU1Bb0dDQ3NHQVFVRkJ3TUNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUIKQVFESWZnS04vcHlUVXJmWllzMisyY1dkQ2dEcjFidHR2eW4rZDRHcEF1Wnc2dnJEQ255OGI5eW1Hc1JYQVNyQgprYUhGQ09RMXd0K3l3eHBEM0ZUWUZpS2IxNE5NUWxRR1JVR0F2MDFrSjhueWVEaFc2MWtnRU5aQWtzOUZSRmNVCkU5K0I2ZmtZaVJCeVhVN0FrS1VWRDg4M2VRekhzNHBjSmN2UG10aGdMZWkxUDFHL01QcVZZQVA3THZ5c0ZualQKOHc0elIxN3NTZElUNTc0YVVOdDE3TTJxTU9sR0dScGVtZVZHUlpGM2d1cFZYajdpOEkyNmt5Q0xMMVN2SldvZQpnRlRDUVJkYmUxZGp2UEQ1UmNVSlNKVnhNWVYybm96L1RIT3QzekxBcUl0M3k2VGRMYStmT0ovNEl3dTBhRExECmdoM0dyaG1VUkovS1ZsRThBMWdCOFpXaQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  managed-cluster.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcjBYZVpaQSt4L2hQWlo4R01UL2Z4a1VodGJFaGtwcUIxcFhSNy9ZVVkvVW0zcjl4ClBjUkVkdnpEUEpKRjFLZUo2L2VUM2FaQWVBRU5BUi9Eb2FYYUpIRFpESXdqYzlQd2lNRDl1UlEvVjYyZERmM3IKdk0wN1VYbVVpV3piMUlhRjJRRktBb2FMcUJLSGRBTnZwTGpjTkJIQ3FBRGtJSi9IY2hVc2JwNkFQcU8vYmFXSQowOHFXMXhzOGtFbExibVowaTdKak9Dd1FwdEN6N2UvYzFZWVVPREVHL3poOU5TcnRhM055b2RzK0NMSlJQTURyCnhXSUY5b2s0TStvOGk0c1BGWGNwRXk5clZ4RW4xbjdXbHl3VVdvQmVxWDRremFEY05Pczh0OXZTUHZwL1ZNZUwKaC9MTUo0SHNMS0tuTGFHb0hZZlVmZEZDcllNdENLOTFONlFnbFFJREFRQUJBb0lCQUN5OWdBU2E2bnV2RmMxUgo1NG5BelVWV05rR2o0bmNDdTZ2aitIL3haOGtRTmdqY0EzTUoyNVFuOTBwSjZFdGRMT2F2L3Uyd1YzcUtnaUJNClZHcTU1Rkl6QUNTa3pSUHZBTkpYdVN4NlQ2VDQ2ME04RXVYUjJaZDFtb1h0NUx0K1QwSlNndXJjSDJBYXdyckoKZWNFcGN3UlRtRVc4WEg4N2FmVGtGTUJ6OHphSnQ4ajdUZTE3S0Q2ekViaEFvRWpvRmtwcThBWUVGL3I3dU8yNQpOMXAwQ3I0Rk5KMmU2NFBHaXc1blZZcE53dDBMZXdUWldtOWdLek1hQVVYeG5BcFdPSFdYMURoM1FmdXZGb3pYCmFaLzAraExCSCtoYy9POU0rMWFycW5ieG9KbndRK0RiVUVjSnYyUkNGcXNtZUdYWWNwRThvTklUVDNuYTlQcEMKMkZsYml5MENnWUVBeklBSldBYmF6ckF1eEFMd0R6Uk5IR0lBNEp0bDBnMFpXUmZmZFFNd3A1cTE4ak5RRzcvMgpIZzE4ZXFSTDN2cUhBNUM3bThrS2t3MXEweGF3RERuUjV1QVBxNXNWOXlSc1FNcVc2azRmVFdEOC9LQ0ZZNTFrClNXWVhlU3NIQTVRc01FUU14RUdWM09lTjc3R1J0RUk3V3JVYTNQQVI4blptK3F3dVJLK3pSNGNDZ1lFQTIybVQKazVrMlJVVUk1YVFCdGVRZlV5TEY1dXc1ZlY4STM3L0wzUC85dUp1Vmc4SnhRd3BrWDZSeGU4aVAyOEswdUtZSQpHOGJkVHdXQWttRnJFT2RKM1BlK3QvOXFHNkJWVXhYS3g0Vy9MU3V3SGp4L2FoaVFnOEZjVnNpMXFHYlJWM01NCkJNMUpnaitFYWphVmplYXdVTWVEbVZMa0Qra1hDdERPOHV0QjVnTUNnWUJ6NGFYcDFOQ095UFZuSzBiL1JxTGYKajRWeHdYMDhQeUg3QTNVanFIQWN1YVdhbm9zcGZtaW45UHB4d01JaGs1T0lhSzUzQThCVFBnb25uYmFhNXZUVAp3R29BMHp2cU5TQ0d3b1lzTmFLMVJWMTJoanV3REJNMUtIM3Fzb0FoL2dmZ1BkK0NJcXdhWnJoZWVCL1pwcUpkCnJ6eU9zQmRyYnI3Q0UybVFrSU9sNXdLQmdBZVlyeWhVREtIM1V1aUlkaHF6RERhWHBKeHJIMDVzNU9UQ1FpK2oKbVVnejhzZytDaWZWQzBhWWJlbG9OenJYa2VRMnMxOHEwbXl5OXhHYVY5ZWMrbHl4SXlSQnJvM0lUa3Z6SERNdQpPVUU2R3YzaEFGUlBCMm5ZWHZjT09lUGJzM0hBcFBEaG5xTG95Zy9YVmZRMHdYUDZoRjdobE0zTU55VUR0N2FICldKKzdBb0dCQUtDeHhQWG8zbUFkV3huWGhRdGc0K2lEZGpaZXNEMFc0MUFYT1ZqZ1FlaTgrbytZcFJjRUluekwKcUlHL3lPb1pZem1NYWNlYjNXUEgvWFdTQUFIOS9CYnBzaGVhYWpKV2pQUDlwclNSTkJEN0FwU2JKeEE2SXRjRQpvanlpM3Jac0dMS3o3eTFoQit6VE5lYmZ0SGpXQ21WK0hvK3RsRy94STZNOTRwMS8xcTBwCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
`

const ExpectedManifestCAPublic = `
# Once applied to your managed cluster, a deployment is created to establish a secure tcp connection
# with the management cluster.

apiVersion: operator.tigera.io/v1
kind: ManagementClusterConnection
metadata:
  name: tigera-secure
spec:
  # ManagementClusterAddr should be the externally reachable address to which your managed cluster
  # will connect. Valid examples are: "0.0.0.0:31000", "example.com:32000", "[::1]:32500"
  managementClusterAddr: "example.org:1234"

  tls:
    ca: "Public"

---

apiVersion: v1
kind: Secret
metadata:
  name: tigera-managed-cluster-connection
  namespace: operator-ns
type: Opaque
data:
  # This is the certificate of the management cluster side of the tunnel.
  management-cluster.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1RENDQWN5Z0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFaTVJjd0ZRWURWUVFERXc1MGFXZGwKY21FdGRtOXNkSEp2YmpBZUZ3MHlNREEyTURReE5ERXpNakJhRncweU5UQTJNRE14TkRFek1qQmFNQmt4RnpBVgpCZ05WQkFNVERuUnBaMlZ5WVMxMmIyeDBjbTl1TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCCkNnS0NBUUVBMjZMd3huYlJsMkxNVGtwSDhBTTZXVWZNYk43SGpibS9oL0c2Uk40MEZVWDFRUkl0UkVUM01LUTEKVUlXbldKa3huYnlEN1VGMy9WaHVtNnNxWFl0OHMwUXRLdDBBWjB4SlNFMFRpUTAyQ0NCYUwvTytkejlIQXZKMQpTMkVHMmVZWjJhT3c4bUIvaVdITEFrSzRMeFpjcHlkZ0VNbU96ZmU1ZDkvV2szMTFTNnp6SHZ5V3l2ckMwVUMvCjBoT09HUFlkTGdGcG8yR1Z3UTJ1Mnk2N0ZsN1VldDJyYXlyaFpQUE51Y3Z5aUFHcGM4VUsxOUJ4ak9reW5oOEwKZmN6VXBPcDBQeHMyMWNQTGppaTJjSlVNMkpXYWtHTjRveHFyMXk3VHo3UVo4YzB4d00zdmtxVE5oT3dGL240UgpTMitJK29VeU1Db3IyS1AvMmdWTThRVzBXbDFqbVFJREFRQUJvemN3TlRBT0JnTlZIUThCQWY4RUJBTUNBcVF3CkR3WURWUjBUQVFIL0JBVXdBd0VCL3pBU0JnTlZIUkVFQ3pBSmdnZDJiMngwY205dU1BMEdDU3FHU0liM0RRRUIKQ3dVQUE0SUJBUUEyNzYwaXZtMEQ3UVRsSktkSHZNODY5RThmUzVJY1dINUQ3UHdac0R0NldFV1JoWFVOMksrQgorL2taN2J0MTZTeTZMNFhkZXdxbS9aWjMvUGpZUTErRVEyM3NDL042a0h5NUlEd01mSk9oN2J3KzFlNlhqSncyCmQxcDBlbzdVcHRiUmlRQWZZcGpER1lCQm1ZcnBVQWI4S0dydDZlcmVTWUh2ZWJqdEJmQ2R1L3FJWkhiY0h3QjgKdmtFOFAzZm54a3NocisrMXVxWG9iNW9KeVB1c2RZVGFrK1NDU3dmRFk0MHVUcnpPMmpKa1ZjWFA3dWtpNE9nZAp3UTdFenByK3lvTkd0c04wU1J1dnU3dFBwak1hWmgrK2RmWmNCb05SYXdWdXlhVWtzc0V5R1VvMXNKaVRsUmVDCjE5ZTUrNDVEdExrYW83bVdmS2RFQ0Y3NUtJcFVTMXVECi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  # The certificate and private key that are created and signed by the CA in the management cluster.
  managed-cluster.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMzakNDQWNhZ0F3SUJBZ0lRTjloaTBwS3ErT3VNYTl3SFFyaWd5akFOQmdrcWhraUc5dzBCQVFzRkFEQVoKTVJjd0ZRWURWUVFERXc1MGFXZGxjbUV0ZG05c2RISnZiakFnRncweU1EQTJNVEF3TURVeU1qaGFHQTh5TVRNMApNRGN3T1RFMk5USXlPRm93RWpFUU1BNEdBMVVFQXhNSFltOW5kWE10TkRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCCkJRQURnZ0VQQURDQ0FRb0NnZ0VCQUs5RjNtV1FQc2Y0VDJXZkJqRS8zOFpGSWJXeElaS2FnZGFWMGUvMkZHUDEKSnQ2L2NUM0VSSGI4d3p5U1JkU25pZXYzazkybVFIZ0JEUUVmdzZHbDJpUncyUXlNSTNQVDhJakEvYmtVUDFldApuUTM5Njd6Tk8xRjVsSWxzMjlTR2hka0JTZ0tHaTZnU2gzUURiNlM0M0RRUndxZ0E1Q0NmeDNJVkxHNmVnRDZqCnYyMmxpTlBLbHRjYlBKQkpTMjVtZEl1eVl6Z3NFS2JRcyszdjNOV0dGRGd4QnY4NGZUVXE3V3R6Y3FIYlBnaXkKVVR6QTY4VmlCZmFKT0RQcVBJdUxEeFYzS1JNdmExY1JKOVorMXBjc0ZGcUFYcWwrSk0yZzNEVHJQTGZiMGo3NgpmMVRIaTRmeXpDZUI3Q3lpcHkyaHFCMkgxSDNSUXEyRExRaXZkVGVrSUpVQ0F3RUFBYU1uTUNVd0RnWURWUjBQCkFRSC9CQVFEQWdXZ01CTUdBMVVkSlFRTU1Bb0dDQ3NHQVFVRkJ3TUNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUIKQVFESWZnS04vcHlUVXJmWllzMisyY1dkQ2dEcjFidHR2eW4rZDRHcEF1Wnc2dnJEQ255OGI5eW1Hc1JYQVNyQgprYUhGQ09RMXd0K3l3eHBEM0ZUWUZpS2IxNE5NUWxRR1JVR0F2MDFrSjhueWVEaFc2MWtnRU5aQWtzOUZSRmNVCkU5K0I2ZmtZaVJCeVhVN0FrS1VWRDg4M2VRekhzNHBjSmN2UG10aGdMZWkxUDFHL01QcVZZQVA3THZ5c0ZualQKOHc0elIxN3NTZElUNTc0YVVOdDE3TTJxTU9sR0dScGVtZVZHUlpGM2d1cFZYajdpOEkyNmt5Q0xMMVN2SldvZQpnRlRDUVJkYmUxZGp2UEQ1UmNVSlNKVnhNWVYybm96L1RIT3QzekxBcUl0M3k2VGRMYStmT0ovNEl3dTBhRExECmdoM0dyaG1VUkovS1ZsRThBMWdCOFpXaQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  managed-cluster.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcjBYZVpaQSt4L2hQWlo4R01UL2Z4a1VodGJFaGtwcUIxcFhSNy9ZVVkvVW0zcjl4ClBjUkVkdnpEUEpKRjFLZUo2L2VUM2FaQWVBRU5BUi9Eb2FYYUpIRFpESXdqYzlQd2lNRDl1UlEvVjYyZERmM3IKdk0wN1VYbVVpV3piMUlhRjJRRktBb2FMcUJLSGRBTnZwTGpjTkJIQ3FBRGtJSi9IY2hVc2JwNkFQcU8vYmFXSQowOHFXMXhzOGtFbExibVowaTdKak9Dd1FwdEN6N2UvYzFZWVVPREVHL3poOU5TcnRhM055b2RzK0NMSlJQTURyCnhXSUY5b2s0TStvOGk0c1BGWGNwRXk5clZ4RW4xbjdXbHl3VVdvQmVxWDRremFEY05Pczh0OXZTUHZwL1ZNZUwKaC9MTUo0SHNMS0tuTGFHb0hZZlVmZEZDcllNdENLOTFONlFnbFFJREFRQUJBb0lCQUN5OWdBU2E2bnV2RmMxUgo1NG5BelVWV05rR2o0bmNDdTZ2aitIL3haOGtRTmdqY0EzTUoyNVFuOTBwSjZFdGRMT2F2L3Uyd1YzcUtnaUJNClZHcTU1Rkl6QUNTa3pSUHZBTkpYdVN4NlQ2VDQ2ME04RXVYUjJaZDFtb1h0NUx0K1QwSlNndXJjSDJBYXdyckoKZWNFcGN3UlRtRVc4WEg4N2FmVGtGTUJ6OHphSnQ4ajdUZTE3S0Q2ekViaEFvRWpvRmtwcThBWUVGL3I3dU8yNQpOMXAwQ3I0Rk5KMmU2NFBHaXc1blZZcE53dDBMZXdUWldtOWdLek1hQVVYeG5BcFdPSFdYMURoM1FmdXZGb3pYCmFaLzAraExCSCtoYy9POU0rMWFycW5ieG9KbndRK0RiVUVjSnYyUkNGcXNtZUdYWWNwRThvTklUVDNuYTlQcEMKMkZsYml5MENnWUVBeklBSldBYmF6ckF1eEFMd0R6Uk5IR0lBNEp0bDBnMFpXUmZmZFFNd3A1cTE4ak5RRzcvMgpIZzE4ZXFSTDN2cUhBNUM3bThrS2t3MXEweGF3RERuUjV1QVBxNXNWOXlSc1FNcVc2azRmVFdEOC9LQ0ZZNTFrClNXWVhlU3NIQTVRc01FUU14RUdWM09lTjc3R1J0RUk3V3JVYTNQQVI4blptK3F3dVJLK3pSNGNDZ1lFQTIybVQKazVrMlJVVUk1YVFCdGVRZlV5TEY1dXc1ZlY4STM3L0wzUC85dUp1Vmc4SnhRd3BrWDZSeGU4aVAyOEswdUtZSQpHOGJkVHdXQWttRnJFT2RKM1BlK3QvOXFHNkJWVXhYS3g0Vy9MU3V3SGp4L2FoaVFnOEZjVnNpMXFHYlJWM01NCkJNMUpnaitFYWphVmplYXdVTWVEbVZMa0Qra1hDdERPOHV0QjVnTUNnWUJ6NGFYcDFOQ095UFZuSzBiL1JxTGYKajRWeHdYMDhQeUg3QTNVanFIQWN1YVdhbm9zcGZtaW45UHB4d01JaGs1T0lhSzUzQThCVFBnb25uYmFhNXZUVAp3R29BMHp2cU5TQ0d3b1lzTmFLMVJWMTJoanV3REJNMUtIM3Fzb0FoL2dmZ1BkK0NJcXdhWnJoZWVCL1pwcUpkCnJ6eU9zQmRyYnI3Q0UybVFrSU9sNXdLQmdBZVlyeWhVREtIM1V1aUlkaHF6RERhWHBKeHJIMDVzNU9UQ1FpK2oKbVVnejhzZytDaWZWQzBhWWJlbG9OenJYa2VRMnMxOHEwbXl5OXhHYVY5ZWMrbHl4SXlSQnJvM0lUa3Z6SERNdQpPVUU2R3YzaEFGUlBCMm5ZWHZjT09lUGJzM0hBcFBEaG5xTG95Zy9YVmZRMHdYUDZoRjdobE0zTU55VUR0N2FICldKKzdBb0dCQUtDeHhQWG8zbUFkV3huWGhRdGc0K2lEZGpaZXNEMFc0MUFYT1ZqZ1FlaTgrbytZcFJjRUluekwKcUlHL3lPb1pZem1NYWNlYjNXUEgvWFdTQUFIOS9CYnBzaGVhYWpKV2pQUDlwclNSTkJEN0FwU2JKeEE2SXRjRQpvanlpM3Jac0dMS3o3eTFoQit6VE5lYmZ0SGpXQ21WK0hvK3RsRy94STZNOTRwMS8xcTBwCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
`

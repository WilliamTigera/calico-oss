{
  "index_patterns": [
    "tigera_secure_ee_l7*"
  ],
  "settings": {
    "number_of_shards": 1,
    "number_of_replicas": 0
  },
  "mappings": {
    "properties": {
      "@timestamp" : {
        "type" : "date"
      },
      "start_time": {
        "type": "date",
        "format": "epoch_second"
      },
      "end_time": {
        "type": "date",
        "format": "epoch_second"
      },
      "duration_mean": {
        "type": "long"
      },
      "duration_max": {
        "type": "long"
      },
      "bytes_in": {
        "type": "long"
      },
      "bytes_out": {
        "type": "long"
      },
      "count": {
        "type": "long"
      },
      /*The current fields prefixed with src_ are deprecated. Please use source_ prefixed fields.*/
      "src_name_aggr": {
        "type": "keyword"
      },
      "src_namespace": {
        "type": "keyword"
      },
      "src_type": {
        "type": "keyword"
      },
      "source_name_aggr": {
        "type": "alias",
        "path": "src_name_aggr"
      },
      "source_namespace": {
        "type": "alias",
        "path": "src_namespace"
      },
      "source_type": {
        "type": "alias",
        "path": "src_type"
      },
      "source_port_num": {
        "type": "long",
        "null_value": "0"
      },
      "dest_service_name": {
        "type": "keyword"
      },
      "dest_service_namespace": {
        "type": "keyword"
      },
      "dest_service_port": {
        /*dest_service_port is deprecated please use dest_service_port_num*/
        "type": "long",
        "null_value": "0"
      },
      "dest_service_port_name": {
          /*
            dest_service_port_name - Destination Service Port Name is the name of the port exposed by the service which the connection is trying to reach.  
            Described in the Service resource specs as specs.[]ports.name. It will have the empty L7 Log character field value of '-' when:
            - the optional port name field in the Service resource is not provided
            - in rare cases where the Service is unavailable (ie. deleted or down) while processing the Service information
        */
        "type": "keyword"
      },
      "dest_service_port_num": {
        /*
          dest_service_port_num - Destination Service Port Number is the numerical value of the port exposed by the service which the connection is trying to reach.  
          Described in the Service resource specs as specs.[]ports.port. It will have the empty L7 Log numerical field value of 0 when:
          - in rare cases where the Service is unavailable (ie. deleted or down) while processing the Service information
          This field replaces dest_service_port.
        */
        "type": "alias",
        "path": "dest_service_port"
      },
      "dest_name_aggr": {
        "type": "keyword"
      },
      "dest_namespace": {
        "type": "keyword"
      },
      "dest_type": {
        "type": "keyword"
      },
      "dest_port_num": {
        "type": "long",
        "null_value": "0"
      },
      "url": {
        "type": "keyword"
      },
      "response_code": {
        "type": "keyword"
      },
      "method": {
        "type": "keyword"
      },
      "user_agent": {
        "type": "keyword"
      },
      "type": {
        "type": "keyword"
      }
    }
  }
}

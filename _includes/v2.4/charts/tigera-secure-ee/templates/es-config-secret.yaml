{{- $elasticMode := include "tigera-secure-ee.elasticsearch.mode" . }}
{{- if eq $elasticMode "external" }}
kind: Secret
apiVersion: v1
metadata:
  name: elastic-fluentd-user
  namespace: calico-monitoring
data:
{{- if .Values.elasticsearch.fluentd.username }}
  username: {{ b64enc .Values.elasticsearch.fluentd.username }}
{{- end }}
{{- if .Values.elasticsearch.fluentd.password }}
  password: {{ b64enc .Values.elasticsearch.fluentd.password }}
{{- end }}

---

apiVersion: v1
kind: Secret
metadata:
  name: elastic-curator-user
  namespace: calico-monitoring
data:
{{- if .Values.elasticsearch.curator.username }}
  username: {{ b64enc .Values.elasticsearch.curator.username }}
{{- end }}
{{- if .Values.elasticsearch.curator.password }}
  password: {{ b64enc .Values.elasticsearch.curator.password }}
{{- end }}

---

apiVersion: v1
kind: Secret
metadata:
  name: elastic-compliance-user
  namespace: calico-monitoring
data:
{{- if .Values.elasticsearch.compliance.controller.username }}
  controller.username: {{ b64enc .Values.elasticsearch.compliance.controller.username }}
{{- end }}
{{- if .Values.elasticsearch.compliance.controller.password }}
  controller.password: {{ b64enc .Values.elasticsearch.compliance.controller.password }}
{{- end }}
{{- if .Values.elasticsearch.compliance.reporter.username }}
  reporter.username: {{ b64enc .Values.elasticsearch.compliance.reporter.username }}
{{- end }}
{{- if .Values.elasticsearch.compliance.reporter.password }}
  reporter.password: {{ b64enc .Values.elasticsearch.compliance.reporter.password }}
{{- end }}
{{- if .Values.elasticsearch.compliance.snapshotter.username }}
  snapshotter.username: {{ b64enc .Values.elasticsearch.compliance.snapshotter.username }}
{{- end }}
{{- if .Values.elasticsearch.compliance.snapshotter.password }}
  snapshotter.password: {{ b64enc .Values.elasticsearch.compliance.snapshotter.password }}
{{- end }}
{{- if .Values.elasticsearch.compliance.server.username }}
  server.username: {{ b64enc .Values.elasticsearch.compliance.server.username }}
{{- end }}
{{- if .Values.elasticsearch.compliance.server.password }}
  server.password: {{ b64enc .Values.elasticsearch.compliance.server.password }}
{{- end }}

---

apiVersion: v1
kind: Secret
metadata:
  name: elastic-ee-intrusion-detection
  namespace: calico-monitoring
data:
{{- if .Values.elasticsearch.intrusionDetection.username }}
  username: {{ b64enc .Values.elasticsearch.intrusionDetection.username }}
{{- end }}
{{- if .Values.elasticsearch.intrusionDetection.password }}
  password: {{ b64enc .Values.elasticsearch.intrusionDetection.password }}
{{- end }}

---

apiVersion: v1
kind: Secret
metadata:
  name: elastic-ee-installer
  namespace: calico-monitoring
data:
{{- if .Values.elasticsearch.elasticInstaller.username }}
  username: {{ b64enc .Values.elasticsearch.elasticInstaller.username }}
{{- end }}
{{- if .Values.elasticsearch.elasticInstaller.password }}
  password: {{ b64enc .Values.elasticsearch.elasticInstaller.password }}
{{- end }}

---

apiVersion: v1
kind: Secret
metadata:
  name: tigera-es-config
  namespace: calico-monitoring
data:
{{- if .Values.elasticsearch.tls.ca }}
  tigera.elasticsearch.ca: {{ .Values.elasticsearch.tls.ca | b64enc }}
{{- end }}
{{- if .Values.elasticsearch.manager.username }}
  tigera.elasticsearch.username: {{ b64enc .Values.elasticsearch.manager.username }}
{{- end }}
{{- if .Values.elasticsearch.manager.password }}
  tigera.elasticsearch.password: {{ b64enc .Values.elasticsearch.manager.password }}
{{- end }}
{{- end }}
